# SMART on FHIR å®Œæ•´æŒ‡å—

æœ¬æŒ‡å—æ•´åˆäº† SMART on FHIR çš„æµç¨‹è¯´æ˜å’Œå¯åŠ¨æ­¥éª¤ã€‚

---

## ğŸ“Š ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [è®¤è¯æµç¨‹](#è®¤è¯æµç¨‹)
3. [å¯åŠ¨æ–¹å¼](#å¯åŠ¨æ–¹å¼)
4. [å…³é”®æ–‡ä»¶](#å…³é”®æ–‡ä»¶)
5. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ€ç®€å•çš„æµ‹è¯•æ–¹å¼

1. **å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨**
   ```bash
   cd MEDCALCEHR
   python -m http.server 8000
   # æˆ–
   npm start
   ```

2. **è®¿é—® SMART Launcher**
   - æ‰“å¼€ï¼šhttps://launch.smarthealthit.org/
   - App Launch URL: `http://localhost:8000/launch.html`
   - é€‰æ‹©ä¸€ä¸ªæµ‹è¯•æ‚£è€…
   - ç‚¹å‡» "Launch"

3. **å®Œæˆï¼** 
   - åº”ç”¨å°†è‡ªåŠ¨å®Œæˆè®¤è¯æµç¨‹
   - æ˜¾ç¤ºæ‚£è€…ä¿¡æ¯å’Œè®¡ç®—å™¨åˆ—è¡¨

---

## ğŸ“Š è®¤è¯æµç¨‹è¯¦è§£

### å®Œæ•´è®¤è¯æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SMART on FHIR èªè­‰æµç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥é©Ÿ 1: å¾ EHR æˆ– SMART Launcher å•Ÿå‹•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EHR / Launcher  â”‚
â”‚                  â”‚
â”‚ é»æ“Šå•Ÿå‹•æ‡‰ç”¨ç¨‹å¼  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ é‡å®šå‘åˆ° launch.html
         â”‚ å¸¶åƒæ•¸: ?iss=...&launch=...
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  launch.html                                         â”‚
â”‚  http://localhost:8000/launch.html?iss=...&launch=...â”‚
â”‚                                                       â”‚
â”‚  è¼‰å…¥ FHIR Client åº«                                  â”‚
â”‚  åŸ·è¡Œ: FHIR.oauth2.authorize({                        â”‚
â”‚    client_id: 'my-app',                              â”‚
â”‚    scope: 'launch/patient patient/*.read',           â”‚
â”‚    redirect_uri: './index.html'                      â”‚
â”‚  })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ è§¸ç™¼ OAuth2 æˆæ¬Šè«‹æ±‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EHR æˆæ¬Šä¼ºæœå™¨   â”‚
â”‚                  â”‚
â”‚  ç”¨æˆ¶ç™»å…¥/æˆæ¬Š    â”‚
â”‚  (æ¸¬è©¦ç’°å¢ƒè‡ªå‹•)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ æˆæ¬ŠæˆåŠŸï¼Œé‡å®šå‘å› index.html
         â”‚ å¸¶åƒæ•¸: ?code=...&state=...
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  index.html                                          â”‚
â”‚  http://localhost:8000/index.html?code=...&state=... â”‚
â”‚                                                       â”‚
â”‚  æª¢æ¸¬åˆ° state åƒæ•¸ â†’ è·³éé‡å®šå‘é‚è¼¯                   â”‚
â”‚  è¼‰å…¥ FHIR Client åº«                                  â”‚
â”‚  åŸ·è¡Œ: FHIR.oauth2.ready()                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ äº¤æ›æˆæ¬Šç¢¼ç²å–å­˜å–ä»¤ç‰Œ
         â”‚ åˆå§‹åŒ– FHIR å®¢æˆ¶ç«¯
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FHIR å®¢æˆ¶ç«¯å°±ç·’                                      â”‚
â”‚                                                       â”‚
â”‚  âœ“ å·²å–å¾—å­˜å–ä»¤ç‰Œ                                     â”‚
â”‚  âœ“ å·²å–å¾—ç—…æ‚£ä¸Šä¸‹æ–‡ (patient.id)                      â”‚
â”‚  âœ“ å¯ä»¥å­˜å– FHIR API                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ å‘¼å« displayPatientInfo(client, div)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API è«‹æ±‚: GET /Patient/{id}                          â”‚
â”‚  â†’ å–å¾—ç—…æ‚£åŸºæœ¬è³‡æ–™ (å§“åã€ç”Ÿæ—¥ã€æ€§åˆ¥)                 â”‚
â”‚                                                       â”‚
â”‚  API è«‹æ±‚: GET /Observation?patient={id}&code=...     â”‚
â”‚  â†’ å–å¾—å¯¦é©—å®¤æ•¸æ“š (éœ€è¦æ™‚)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¡¯ç¤ºç—…æ‚£è³‡è¨Šèˆ‡è¨ˆç®—å™¨                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ‘¤ ç—…æ‚£è³‡è¨Š                                     â”‚ â”‚
â”‚  â”‚ å§“å: John Doe                                 â”‚ â”‚
â”‚  â”‚ å‡ºç”Ÿæ—¥æœŸ: 1980-01-01 (å¹´é½¡: 45)                â”‚ â”‚
â”‚  â”‚ æ€§åˆ¥: Male                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                       â”‚
â”‚  âœ“ å¯ä»¥ä½¿ç”¨æ‰€æœ‰è¨ˆç®—å™¨                                 â”‚
â”‚  âœ“ è¨ˆç®—å™¨å¯ä»¥è‡ªå‹•å¡«å…¥ç—…æ‚£æ•¸æ“š                          â”‚
â”‚  âœ“ å¯ä»¥æŸ¥è©¢å¯¦é©—å®¤æ•¸æ“š                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ å¯åŠ¨æ–¹å¼

### æ–¹å¼ä¸€ï¼šSMART Health IT æ²™ç›’ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰

è¿™æ˜¯æœ€ç®€å•çš„æµ‹è¯•æ–¹å¼ï¼Œä½¿ç”¨å…¬å¼€çš„æ²™ç›’ç¯å¢ƒã€‚

#### æ­¥éª¤ï¼š

1. **è®¿é—® SMART Launcher**
   - å‰å¾€ï¼šhttps://launch.smarthealthit.org/

2. **é…ç½®å¯åŠ¨å‚æ•°**
   ```
   App Launch URL: http://localhost:8000/launch.html
   Launch Type: Provider EHR Launch
   Patient: é€‰æ‹©ä»»ä½•æµ‹è¯•æ‚£è€…
   Provider: é€‰æ‹©ä»»ä½•æµ‹è¯•åŒ»ç”Ÿ
   FHIR Version: R4
   ```

3. **ç‚¹å‡» "Launch"**
   - ç³»ç»Ÿä¼šè‡ªåŠ¨å®Œæˆ OAuth2 æµç¨‹
   - é‡å®šå‘å›æ‚¨çš„åº”ç”¨

4. **éªŒè¯æˆåŠŸ**
   - åº”æ˜¾ç¤ºæ‚£è€…ä¿¡æ¯
   - æ‰€æœ‰è®¡ç®—å™¨å¯ç”¨
   - å¯è‡ªåŠ¨å¡«å…¥ FHIR æ•°æ®

### æ–¹å¼äºŒï¼šæœ¬åœ° FHIR æœåŠ¡å™¨

å¦‚æœæ‚¨æœ‰æœ¬åœ° FHIR æœåŠ¡å™¨ï¼š

1. **å¯åŠ¨ FHIR æœåŠ¡å™¨**
   ```bash
   # ä¾‹å¦‚ä½¿ç”¨ HAPI FHIR
   docker run -p 8080:8080 hapiproject/hapi:latest
   ```

2. **ä¿®æ”¹ launch.html**
   ```javascript
   const defaultIss = 'http://localhost:8080/fhir';
   ```

3. **ä» EHR å¯åŠ¨**
   - ä½¿ç”¨æ‚¨çš„ EHR ç³»ç»Ÿçš„ SMART å¯åŠ¨åŠŸèƒ½
   - é…ç½® App Launch URL: `http://localhost:8000/launch.html`

### æ–¹å¼ä¸‰ï¼šDocker ç¯å¢ƒ

ä½¿ç”¨ Docker è¿è¡Œåº”ç”¨ï¼š

```bash
cd MEDCALCEHR
docker-compose up -d

# è®¿é—®
http://localhost:8080/launch.html
```

**æ³¨æ„**ï¼šDocker ç¯å¢ƒéœ€è¦ç¡®ä¿åº”ç”¨å¯ä»å¤–éƒ¨è®¿é—®ï¼ˆSMART Launcher éœ€è¦é‡å®šå‘åˆ°æ‚¨çš„åº”ç”¨ï¼‰ã€‚

---

## ğŸ”‘ å…³é”®æ–‡ä»¶è¯´æ˜

### 1. launch.html

**ç›®çš„**ï¼šå¯åŠ¨ OAuth2 è®¤è¯æµç¨‹

**ä½•æ—¶ä½¿ç”¨**ï¼š
- ä» EHR ç³»ç»Ÿå¯åŠ¨åº”ç”¨æ—¶
- é¦–æ¬¡è®¿é—®éœ€è¦æ‚£è€…ä¸Šä¸‹æ–‡æ—¶

**æ ¸å¿ƒä»£ç **ï¼š
```javascript
FHIR.oauth2.authorize({
    client_id: 'my-app',
    scope: 'launch/patient patient/*.read openid fhirUser',
    redirect_uri: './index.html'
});
```

### 2. index.html

**ç›®çš„**ï¼šåº”ç”¨ä¸»é¡µé¢ï¼Œæ˜¾ç¤ºè®¡ç®—å™¨åˆ—è¡¨

**è®¤è¯æ£€æŸ¥é€»è¾‘**ï¼š
```javascript
// å¦‚æœæ²¡æœ‰ OAuth state ä¸”æ²¡æœ‰å·²å­˜åœ¨çš„ sessionï¼Œé‡å®šå‘åˆ° launch
if (!/state=/.test(location.search) && !sessionStorage.getItem('SMART_KEY')) {
    window.location.href = 'launch.html';
}
```

**åˆå§‹åŒ– FHIR å®¢æˆ·ç«¯**ï¼š
```javascript
FHIR.oauth2.ready()
    .then(client => {
        displayPatientInfo(client, patientInfoDiv);
    })
    .catch(error => {
        console.log('FHIR client not ready, using offline mode');
    });
```

### 3. calculator.html

**ç›®çš„**ï¼šæ˜¾ç¤ºå•ä¸ªè®¡ç®—å™¨

**è¡Œä¸º**ï¼š
- å°è¯•åˆå§‹åŒ– FHIR å®¢æˆ·ç«¯
- å¦‚æœæˆåŠŸï¼Œè‡ªåŠ¨å¡«å…¥æ‚£è€…æ•°æ®
- å¦‚æœå¤±è´¥ï¼Œä»å¯æ‰‹åŠ¨è¾“å…¥ä½¿ç”¨

### 4. utils.js

**ç›®çš„**ï¼šæä¾› FHIR æ•°æ®è®¿é—®å·¥å…·å‡½æ•°

**ä¸»è¦å‡½æ•°**ï¼š
```javascript
// è·å–è§‚å¯Ÿå€¼
getMostRecentObservation(client, '8480-6')  // æ”¶ç¼©å‹

// è·å–æ‚£è€…æ¡ä»¶
getPatientConditions(client, ['38341003'])  // é«˜è¡€å‹

// æ˜¾ç¤ºæ‚£è€…ä¿¡æ¯
displayPatientInfo(client, divElement)
```

---

## ğŸ”„ URL å‚æ•°è¯´æ˜

### å¯åŠ¨æ—¶ (launch.html)
```
http://localhost:8000/launch.html?iss=FHIR_SERVER&launch=LAUNCH_TOKEN
```
- `iss`: FHIR æœåŠ¡å™¨çš„åŸºç¡€ URL
- `launch`: EHR æä¾›çš„å¯åŠ¨ä»¤ç‰Œï¼ˆåŒ…å«æ‚£è€…ä¸Šä¸‹æ–‡ï¼‰

### è®¤è¯å (index.html)
```
http://localhost:8000/index.html?code=AUTH_CODE&state=STATE_TOKEN
```
- `code`: æˆæƒç ï¼ˆç”¨äºäº¤æ¢è®¿é—®ä»¤ç‰Œï¼‰
- `state`: çŠ¶æ€ä»¤ç‰Œï¼ˆé˜²æ­¢ CSRF æ”»å‡»ï¼‰

---

## ğŸ’¾ Session Storage

FHIR å®¢æˆ·ç«¯ä½¿ç”¨ sessionStorage å­˜å‚¨ï¼š

```javascript
{
    'SMART_KEY': {
        serverUrl: 'FHIRæœåŠ¡å™¨URL',
        tokenResponse: {
            access_token: 'è®¿é—®ä»¤ç‰Œ',
            patient: 'æ‚£è€…ID',
            expires_in: 3600
        }
    },
    'patientData': 'æ‚£è€…èµ„æ–™çš„ JSON å­—ç¬¦ä¸²'
}
```

**æ£€æŸ¥æ–¹å¼**ï¼š
1. å¼€å¯å¼€å‘è€…å·¥å…· (F12)
2. Application â†’ Session Storage â†’ http://localhost:8000
3. æŸ¥çœ‹ `SMART_KEY` å’Œ `patientData`

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: æ­£å¸¸å¯åŠ¨ï¼ˆæœ‰ SMART è®¤è¯ï¼‰
```
1. SMART Launcher â†’ launch.html?iss=...&launch=...
2. OAuth2 è®¤è¯
3. index.html?code=...&state=...
4. å®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸ
5. æ˜¾ç¤ºæ‚£è€…ä¿¡æ¯ âœ“
```

### åœºæ™¯ 2: ç›´æ¥è®¿é—®ï¼ˆæ— è®¤è¯ï¼‰
```
1. ç›´æ¥è®¿é—® index.html
2. æ£€æŸ¥æ²¡æœ‰ state å‚æ•°
3. æ£€æŸ¥æ²¡æœ‰ SMART_KEY
4. è‡ªåŠ¨é‡å®šå‘åˆ° launch.html
5. ä½¿ç”¨é»˜è®¤ iss å¯åŠ¨è®¤è¯
```

### åœºæ™¯ 3: å·²æœ‰ Session
```
1. è®¿é—® index.html
2. æ£€æŸ¥åˆ° sessionStorage æœ‰ SMART_KEY
3. ä¸é‡å®šå‘ï¼Œç›´æ¥åˆå§‹åŒ–
4. ä½¿ç”¨ç¼“å­˜çš„æ‚£è€…èµ„æ–™ âœ“
```

### åœºæ™¯ 4: ç¦»çº¿æ¨¡å¼
```
1. ç›´æ¥è®¿é—® calculator.html?id=bmi-bsa
2. FHIR å®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥
3. æ˜¾ç¤º "FHIR client not ready"
4. ä»å¯æ‰‹åŠ¨è¾“å…¥ä½¿ç”¨è®¡ç®—å™¨ âœ“
```

---

## â“ å¸¸è§é—®é¢˜

### Q: "FHIR client not ready" æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

**åŸå› **ï¼š
- æ²¡æœ‰ç»è¿‡ OAuth2 è®¤è¯æµç¨‹
- Session å·²è¿‡æœŸ
- è®¤è¯å¤±è´¥

**è§£å†³æ–¹æ³•**ï¼š
1. æ¸…é™¤ sessionStorageï¼ˆF12 â†’ Application â†’ Clearï¼‰
2. é‡æ–°ä» SMART Launcher å¯åŠ¨
3. æˆ–ç›´æ¥æ‰‹åŠ¨è¾“å…¥æ•°æ®ä½¿ç”¨è®¡ç®—å™¨

### Q: ä¸ºä»€ä¹ˆè®¿é—® launch.html æ˜¾ç¤º 404ï¼Ÿ

**åŸå› **ï¼š
- Docker å®¹å™¨ä¸åŒ…å« launch.html
- æ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®

**è§£å†³æ–¹æ³•**ï¼š
```bash
# é‡æ–°æ„å»º Docker é•œåƒ
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### Q: å¦‚ä½•æµ‹è¯•ä¸åŒçš„æ‚£è€…ï¼Ÿ

åœ¨ SMART Launcher ä¸­ï¼š
1. ç‚¹å‡» "Change Patient"
2. é€‰æ‹©ä¸åŒçš„æµ‹è¯•æ‚£è€…
3. é‡æ–°å¯åŠ¨åº”ç”¨

### Q: è®¡ç®—å™¨æ²¡æœ‰è‡ªåŠ¨å¡«å…¥æ•°æ®ï¼Ÿ

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ“ FHIR å®¢æˆ·ç«¯å·²åˆå§‹åŒ–ï¼Ÿï¼ˆæŸ¥çœ‹æ§åˆ¶å°ï¼‰
2. âœ“ æ‚£è€…æœ‰ç›¸å…³çš„è§‚å¯Ÿå€¼ï¼Ÿï¼ˆéƒ¨åˆ†æµ‹è¯•æ‚£è€…æ•°æ®ä¸å®Œæ•´ï¼‰
3. âœ“ LOINC ä»£ç æ­£ç¡®ï¼Ÿï¼ˆå‚è€ƒ `js/fhir-codes.js`ï¼‰
4. âœ“ ç½‘ç»œè¯·æ±‚æˆåŠŸï¼Ÿï¼ˆæŸ¥çœ‹ Network æ ‡ç­¾ï¼‰

### Q: å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Ÿ

1. **æ³¨å†Œåº”ç”¨**ï¼šåœ¨æ‚¨çš„ EHR ç³»ç»Ÿæ³¨å†Œ SMART åº”ç”¨
2. **è·å– client_id**ï¼šä» EHR è·å–
3. **é…ç½®åŸŸå**ï¼šä½¿ç”¨ HTTPS å’Œæ­£å¼åŸŸå
4. **æ›´æ–° redirect_uri**ï¼šæŒ‡å‘ç”Ÿäº§ç¯å¢ƒ URL
5. **é…ç½® launch.html**ï¼šä½¿ç”¨ç”Ÿäº§ç¯å¢ƒçš„ client_id

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [SMART App Launch è§„èŒƒ](http://hl7.org/fhir/smart-app-launch/)
- [FHIR Client JavaScript æ–‡æ¡£](https://github.com/smart-on-fhir/client-js)
- [OAuth 2.0 æˆæƒç æµç¨‹](https://oauth.net/2/grant-types/authorization-code/)
- [LOINC ä»£ç æŸ¥è¯¢](https://loinc.org/)
- [SNOMED CT æµè§ˆå™¨](https://browser.ihtsdotools.org/)

---

## ğŸ”§ å¼€å‘æç¤º

### æŸ¥çœ‹ FHIR è¯·æ±‚

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š
```
F12 â†’ Network â†’ Fetch/XHR
```

æ‰€æœ‰ FHIR API è¯·æ±‚éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œã€‚

### è°ƒè¯•è®¤è¯æµç¨‹

åœ¨ `launch.html` å’Œ `index.html` ä¸­æ·»åŠ ï¼š
```javascript
console.log('Current URL:', window.location.href);
console.log('Session Storage:', sessionStorage.getItem('SMART_KEY'));
```

### å¥åº·æ£€æŸ¥

è®¿é—®ï¼š`http://localhost:8000/health-check.html`

è‡ªåŠ¨æ£€æŸ¥ï¼š
- âœ“ FHIR å®¢æˆ·ç«¯çŠ¶æ€
- âœ“ Session Storage
- âœ“ æ‚£è€…æ•°æ®
- âœ“ è®¡ç®—å™¨åŠ è½½

---

**æç¤º**ï¼šé‡åˆ°é—®é¢˜ï¼ŸæŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼

